<head>
<link rel="stylesheet" type="text/css" href="style.css">
</head>

<p>A redditor asked the people of <a href="https://www.reddit.com/r/thewire">/r/TheWire</a> to rank the five seasons of the HBO television show <a href="http://www.hbo.com/the-wire">"The Wire"</a>, and <a href="https://www.reddit.com/r/TheWire/comments/50jm4h/ranking_the_seasons/">several people posted their rankings</a>. I wanted to take their individual rankings and uncover one aggregate ranking that captured the overall preferences of the entire group of posters. In other words, I wanted to implement a <a href="https://en.wikipedia.org/wiki/Ranked_voting_system">preferential voting scheme</a>.</p>

<p>I was aware of <a href="https://www.math.ucla.edu/~tao/arrow.pdf">Arrow's theorem</a>, which says that no voting scheme can satisfy a certain small set of reasonable criteria when voters are ranking three or more alternatives. However, I was also aware that a number of countries employ preferential voting systems. So, I didn't give up, and I searched for a preferential voting system that would fit the bill.</p>

<p>I found one that worked: <a href="https://en.wikipedia.org/wiki/Ranked_pairs">the ranked pairs voting scheme</a>. In the ranked pairs voting system, you first count all the times that voters ranked Alternative X ahead of Alternative Y, for all pairs of alternatives X and Y. If more voters ranked Alternative X ahead of Alternative Y, then we say that Alternative X is a majority over Alternative Y, and we represent X's majority over Y as (X, Y).</p>

<p>Now you sort all the majorities. For example, say that we have two majorities, (X, Y) and (A, B). Voters ranked Alternative X ahead of Alternative Y three times, and they ranked Alternative A ahead of Alternative B five times. So, (A, B) comes before (X, Y) in the sort.</p>

<p>But what if the sorted list of majorities creates a <a href="toposort.html">cycle</a>? For example, say that we have [(A, B), (B, C), (C, A)]. Then A is a majority over B and B is a majority over C. But C is a majority over A. So, by transitivity, A is a majority over A - but that is a contradiction.</p>

<p>Here's how you resolve that issue. You build a <a href="toposort.html">directed acyclic graph (DAG)</a>, where the DAG contains a directed edge from X to Y only if X is a majority over Y. You build the DAG by going down the sorted list of majorities. For each majority, you try to add a corresponding edge to the DAG. If adding that edge would produce a cycle, then you don't add it. If it wouldn't produce a cycle, then you do add it. If you do add a majority, then that majority gets "locked in" to the final list of majorities. </p>

<p>The winner of the election is the source of the DAG. The source of the DAG is the vertex that doesn't have any incoming edges. It corresponds to an alternative that no other alternative is a majority over.</p>

<p>However, I didn't want to know just the winner. I wanted to know the aggregate ranking. So, I sorted the alternatives by the number of outgoing edges that their corresponding vertices have in the DAG. The number of outgoing edges of a vertex corresponds to the number of alternatives that an alternative is a majority over.</p>

<p>I collected the data on the night of September 1. I simply scrolled down the list of comments and recorded the rankings that commenters reported. The only complication was that a couple of commenters expressed indifference between some seasons. So, for example, one person wrote, "4 > 1 > 3/2 > 5". In such a case, I ranked seasons in the order that they were written. So, in this particular case, I placed Season 3 before Season 2.</p>

<p>Then I ran the program, and the result was 4 > 1 > 2 > 3. Season 5 didn't even make the list.</p>

<p>You can find <a href="https://github.com/jdanray/blog-code/blob/master/problems/ranked_pairs.py">my program</a> up at <a href="https://github.com/jdanray/blog-code">my GitHub</a>.</p>

<p>Further references:</p>

<p>https://users.cs.duke.edu/~conitzer/comsocchapter.pdf</p>
<p>http://www.geeksforgeeks.org/detect-cycle-in-a-graph/</p>
